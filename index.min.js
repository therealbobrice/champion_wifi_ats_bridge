var GetDataTimer=2,StartRunTimer=3,SleepTimer=2,Debug=!1,ShowGet=!1,ShowApiData=!1,SGDataFlag=!1,DataInfoObj=[],PageS="Set",MaxWW=1290,MinWW=320,VersionInfo="Web Version : V 1.2.1 \n";Debug=!1;
function ShowVersionInfo(){var a=["ATS Version : ","GCU Version : ","WIFI Version : "],c="Infomation   \n";try{for(var e=DataInfoObj.ATS_GCU_WIFI_Software_Reversion,f=0;3>f;f++){var g=e.search("<"),h=e.search(">");c=c+a[f]+"V "+e.substr(g+1,h-g-1)+"  \n";e=e.substr(h+1,e.length)}}catch(k){}c+=VersionInfo;alert(c)}DatastrUrl=Debug?"./testdata.html":"./get_info";window["AutoAdjustment,"]=AutoAdjustment;window.StartRun=StartRun;window.ShowData=ShowData;window.GetAPIData=GetAPIData;window.CheckDate=CheckDate;
window.ChangeDay=ChangeDay;window.createAJAX=createAJAX;window.GetTimeNow=GetTimeNow;window.SandCmd=SandCmd;window.Math=Math;window.UpdateData=UpdateData;window.GetDivStr=GetDivStr;window.GetDivStr1=GetDivStr1;window.GetComStr=GetComStr;window.GetWifiComStr=GetWifiComStr;window.TimeEdit=TimeEdit;window.TimeSet=TimeSet;window.ExerciseEdit=ExerciseEdit;window.CheckFeq=CheckFeq;window.ExerciseSet=ExerciseSet;window.NETEdit=NETEdit;window.GetAbsolutePos=GetAbsolutePos;window.ShowWifiSS=ShowWifiSS;
window.NETSet=NETSet;window.SelChangeMode=SelChangeMode;window.Cancel_NetWork_Setting=Cancel_NetWork_Setting;window.ApplyChange=ApplyChange;window.CancalExerSet=CancalExerSet;window.CancalTimeSet=CancalTimeSet;window.Ch_Reflash=Ch_Reflash;window.GetDateDiff=GetDateDiff;window.dynamicRadioButton=dynamicRadioButton;window.dynamicSPAN=dynamicSPAN;window.TW=TW;window.ReTurnStr=ReTurnStr;window.ReTurnInt=ReTurnInt;window.TraWeek=TraWeek;window.CleanDiv=CleanDiv;window.JsonSort=JsonSort;
window.ChButtonCss=ChButtonCss;window.Transformation=Transformation;window.RemoveBlank=RemoveBlank;window.SleepTime=SleepTime;window.ChangeSetCss=ChangeSetCss;window.CancelSetCss=CancelSetCss;window.Hid=Hid;window.Vis=Vis;window.TranMode=TranMode;window.ShowDetail=ShowDetail;window.GetTime=GetTime;window.ShowGenData=ShowGenData;window.Binglight=Binglight;window.GreatData=GreatData;window.GreatSwitch16=GreatSwitch16;window.GreatSwitch12=GreatSwitch12;window.BindSwLable=BindSwLable;
window.BindSwitch10=BindSwitch10;window.BindSwitch12=BindSwitch12;window.Bindknob=Bindknob;window.SetCss=SetCss;window.ShowNote=ShowNote;window.ButtonClick=ButtonClick;window.GoGo=GoGo;window.SortCheckNull=SortCheckNull;window.SNPage=SNPage;window.setCookie=setCookie;window.getCookie=getCookie;window.listCookies=listCookies;window.clearAllCookie=clearAllCookie;window.delCookie=delCookie;
var EditFlag=[!1,!1,!1],M_Arr="January February March April May June July August September October November December".split(" "),D_Arr="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),RT_Arr="5 Min;10 Min;15 Min;20 Min;25 Min;30 Min".split(";"),ExMode=["No Exercise","1X/Month","2X/Month","4X/Month","Every Week"],PAM_Arr=["AM","PM"],IS_Arr=["Direct Connect","Cloud Service"],WPM_Arr=["AP Mode","Client Mode"],WifiL_Arr="Security: ;Web Address: ;Mask: ;GateWay: ;SSID: ;Password: ".split(";"),
NetN_Arr=["Name1","Name2","Name3"],NetCount=3,NetT_Arr="OPEN WEP_PSK WEP_SHARED WPA_TKIP_PSK WPA_AES_PSK WPA2_AES_PSK WPA2_TKIP_PSK WPA2_MIXED_PSK WPS_OPEN WPS_SECURE UNKNOWN".split(" "),CHSC_Arr=["","CONFIRM DATE & TIME","CONFIRM EXERCISE FREQUENCY","CONFIRM NETWORK SETTINGS"],CASC_Arr=["","EDIT DATE & TIME","EDIT EXERCISE FREQUENCY","EDIT NETWORK SETTINGS"],Storage_Arr=[],Storage_Arr1=[],TimeIsCh=!1,ParaHasCh=!1,AP_list=[],AP_WifiSS=[],SystemDate,DataCh=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],Storage_C=
0,ComStr="",S0LF=[],S1LF=[];DataInfoObj=[];
var WifiInfoObj=[],IPInfoObj=[],AJ_Ti,AutoAdS=!1,SetNetMode="-",LableArr0="Load Module 1 Lockout;Load Module 2 Lockout;Load Module 3 Lockout;Load Module 4 Lockout;Frequency Protected Point;Spare;Power Management;Under PLC Control;Exercise With Load;Master(On) / Slave(Off);Weekly Exercise Function;Generator Take Load Delay".split(";"),SData1="Switch 1\u30012;Switch 3;Switch 4;Switch 5;Switch 6\u30017;Switch 8;Switch 9;Switch 10".split(";"),SData2="Stop Interval<p>[OFF/OFF] 5 Sec<br>[ON/OFF] 10 Sec<br>[OFF/ON] 15 Sec<br>[ON/ON] 20 Sec;Frequency<p>[OFF] 50 Hz<br>[ON] 60 Hz;Oil Press Switch<p>[OFF] Normal Close<br>[ON] Normal Open;Idle (Pre Heat) Interval<p>[OFF] Pre Heat Interval 1 Sec<br>Idle Interval 10 Sec<br>[ON] Pre Heat Interval 10 Sec<br>Idle Interval 30 Sec;Cooling Time<p>[OFF/OFF] 0 Sec<br>[ON/OFF] 60 Sec<br>[OFF/ON] 150 Sec<br>[ON/ON] 300 Sec;Pre Heat / Idle<p>[OFF] Pre Heat<br>[ON] Idle;PLC Detection<p>[OFF] ATS Switch<br>[ON] PLC;Deactivate Starter Frequency<p>[OFF] Over 20 Hz<br>[ON] Over 28 Hz".split(";"),ATSLitArr=
"PMT;ATSPOS ;UTIL;GEN;LMM4;LMM3;LMM2;LMM1;AC1;AC2;GSTART;GSTOP".split(";"),RelayArr="ATS Engage;Select GEN;ATS Escape;NULL;NULL;AC1;AC2;NULL".split(";"),CTArr="T.D.E.S;T.D.E.N;T.D.N.E;T.D.E.C;Swap to Normal Side;Swap to Emergency Side;Normal Side Power Within Range;Load Power Available".split(";"),AGPSArr="Gen Over Voltage;Gen Under Voltage;Gen Over Freq;Gen Uuder Freq;Gen Unbalence Voltage;Gen In Normal;NULL;NULL".split(";"),AUPSArr="Util Over Voltage;Util Under Voltage;Util Over Freq;Util Under Freq;Util Unbalence Voltage;Util In Normal;NULL;Utiliy Block Out".split(";"),
GASLArr="Low Oil Press;High Water Temp;Over Frequency;Under Frequency;AC Over Volt;AC Uuder Volt;Low Battery;GENSet On".split(";"),GBSLArr="Off icon;Auto icon;Man icon;Rtcc icon;Eexrcise icon;Alarm icon;Util Take Load;GEN Take Load".split(";"),GDIArr="Bat Weak Power;Low Oil Pressure;High Water Temp;Low Battery;Over Frequency;Low Frequency;AC Under Volt;AC Over Volt".split(";"),GROArr=["Motor","Valve","Alarm","Stop","Preheat"],CiStr="P1Ci_",P1CiCount=9,GD_ti,FristLoad;FristLoad=!0;var DatastrUrl;
window.onload=function(){AutoAdjustment();SleepTime("loading",StartRunTimer,100);"Data"==getCookie("Page")?ShowData("Data"):ShowData("Set");document.getElementById("SPL").style.display="block";delCookie("Page");window.setTimeout("StartRun()",1E3*StartRunTimer)};
function AutoAdjustment(){clearInterval(AJ_Ti);var a=parseInt(document.body.clientWidth,10);if(a>MaxWW){var c=MaxWW;a=(a-MaxWW)/2}else c=a<MinWW?MinWW:a,a=0;document.getElementById("LogoAdDiv").style.width=c+"px";document.getElementById("LogoAdDiv").style.marginLeft=a+"px";document.getElementById("WDW").style.width=c+"px";document.getElementById("WDW").style.marginLeft=a+"px";document.getElementById("DDD").style.width=c+"px";document.getElementById("DDD").style.marginLeft=a+"px";document.getElementById("EEE").style.width=
c+"px";document.getElementById("EEE").style.marginLeft=a+"px";document.getElementById("SaveDivInside").style.width=c+"px";document.getElementById("SaveDivInside").style.marginLeft=a+"px";AJ_Ti=window.setTimeout("AutoAdjustment()",500)}
function StartRun(){GetAPIData(DatastrUrl);GreatData("ATSLIT",ATSLitArr,"Gendata2");GreatData("Relay",RelayArr,"Gendata2");GreatData("ControlTime",CTArr,"Gendata2");GreatData("AGPS",AGPSArr,"Gendata2");GreatData("AUPS",AUPSArr,"Gendata2");GreatSwitch12("ParaListFrm_0_1","SP0_");BindSwLable("SP0_Lable",LableArr0);GreatSwitch10("ParaListFrm_0_2","SP1_");BindGenSwLable("SP1_Lable",SData1,SData2);GreatData("GASL",GASLArr,"Gendata2");GreatData("GBSL",GBSLArr,"Gendata2");GreatData("GDI",GDIArr,"Gendata2");
GreatData("GRO",GROArr,"Gendata2")}
function ShowData(a){"Data"==a?(document.getElementById("SettingPage").style.display="none",document.getElementById("DataPage").style.display="block",document.getElementById("SPL").setAttribute("onclick","ShowData('Set');"),document.getElementById("SPLImg").src="images/Settings.png",document.getElementById("DisplacementButton").style.display="block",document.getElementById("DDD").innerHTML="Home Standby Generator Info",document.getElementById("SPL").style.display="block",PageS="Data"):"Set"==a&&(document.getElementById("SettingPage").style.display=
"block",document.getElementById("DataPage").style.display="none",document.getElementById("SPL").setAttribute("onclick","ShowData('Data');"),document.getElementById("SPLImg").src="images/DataList.png",document.getElementById("DisplacementButton").style.display="none",document.getElementById("DDD").innerHTML="Home Standby Generator Settings",PageS="Set")}var GetAPISTATUS=!1,GetErrorCount=0;
function GetAPIData(a){GetAPISTATUS?console.log("GetAPISTATUS = true"):(clearInterval(GD_ti),Debug?(DataInfoObj=GetDataInfo(),DataInfoObj=eval(DataInfoObj),ShowGet&&console.log(new Date+" = > get_Virtual_Data"),GetAPISTATUS=!1,"Data"==PageS?ShowGenData():"Set"==PageS&&UpdateData(),GD_ti=window.setInterval("GetAPIData('"+a+"')",1E3*GetDataTimer)):(new Promise(function(c,e){GetAPISTATUS=!0;DataInfoObj.length=0;GetAPIPromise=new createAJAX;if(!GetAPIPromise)return alert("Not Support XMLHttpRequest"),
0;GetAPIPromise.timeout="3000";try{GetAPIPromise.open("GET",a,!0),ShowGet&&console.log(new Date+" = > get_info"),GetAPIPromise.onreadystatechange=function(){4==GetAPIPromise.readyState&&0==GetAPIPromise.status?e():4==GetAPIPromise.readyState&&(200==GetAPIPromise.status?(DataInfoObj="",DataInfoObj=eval("("+GetAPIPromise.responseText+")"),ShowApiData&&(console.log(new Date+" = > get_info data-----------------------"),console.log(DataInfoObj)),DataInfoObj.ATS_System_Datetime&&c()):404==GetAPIPromise.status&&
e())},GetAPIPromise.send("")}catch(f){e()}})).then(function(c){GetErrorCount=0;GetAPISTATUS=!1;"Data"==PageS?ShowGenData():"Set"==PageS&&UpdateData();GD_ti=window.setInterval("GetAPIData('"+a+"')",1E3*GetDataTimer)},function(c){GetErrorCount++;if(4<GetErrorCount){GetErrorCount=0;c="";switch(SetNetMode){case "AP":c="Set To AP Mode <br> Please Reconnect To The Internet";break;case "CL":c="Set To Client Mode <br> Please Reconnect To The Internet";break;case "-":c="Connect Error ! <br> Please Reconnect To The Internet"}ShowMsg(c)}GetAPISTATUS=
!1;GD_ti=window.setInterval("GetAPIData('"+a+"')",3E3);ShowGet&&console.log(new Date+" = > \u9023\u7dda\u7570\u5e38 \uff0cRESET! ")}))}
function CheckDate(){var a="On";document.getElementById("Radio0_0").checked&&(a="Off");var c=!0;Storage_Arr1[4]==a&&(c=!1);for(a=0;7>a;a++)document.getElementById("S0_"+a).value!=S0LF[a]&&3!=a&&(c=!0);if(c){for(a=0;2>=a;a++)if(document.getElementById("S0_"+a).value==S0LF[a])return"Date";for(a=4;7>=a;a++)if(document.getElementById("S0_"+a).value==S0LF[a])return"Time";return"SetOK"}return"NoSet"}
function ChangeDay(){var a=!0;for(x=0;3>x;x++)Sel=document.getElementById("S0_"+x),Sel.value==S0LF[x]&&(a=!1);if(a){a=parseInt(document.getElementById("S0_2").value,10)+2019;var c=parseInt(document.getElementById("S0_0").value,10)+1,e=parseInt(document.getElementById("S0_1").value,10)+1,f=30;1==c||3==c||5==c||7==c||8==c||10==c||12==c?f=31:2==c&&(f=28);e>f&&(document.getElementById("S0_1").value=0,alert("Date Error!"));a=GetDateDiff(a+"/"+c+"/"+e,5);-1==a&&(a=6);document.getElementById("S0_3").value=
a}}function createAJAX(){if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return alert("Your browser does not support AJAX - please use a different browser."),null}}else return window.XMLHttpRequest?(tmpreq=new XMLHttpRequest,tmpreq.overrideMimeType&&tmpreq.overrideMimeType("text/xml"),tmpreq):null}
function GetTimeNow(){var a=(new Date).toUTCString();Storage_Arr1[0]=GetDateDiff(a,0);Storage_Arr1[1]=TraWeek(1,GetDateDiff(a,5));Storage_Arr1[2]=GetDateDiff(a,1);TimeEdit("GetTime");ChangeDay();CheckDate()}
function SandCmd(a){SandCmd_info=new createAJAX;if(!SandCmd_info)return alert("Not Support XMLHttpRequest"),0;SandCmd_info.timeout="10000";SandCmd_info.open("GET",a,!0);ShowGet&&console.log(new Date+" = > SandCmd");SandCmd_info.onreadystatechange=function(){4==SandCmd_info.readyState&&200==SandCmd_info.status&&(alert(SandCmd_info.responseText),SleepTime("CUP",5,100),clearTimeout(GD_ti),FristLoad=!0,setTimeout("GetAPIData('"+DatastrUrl+"')",5E3))};SandCmd_info.send("")}
function BingSN(){var a=DataInfoObj.controller_ID;a=a.substr(a.length-4,4);document.getElementById("CPID")&&(document.getElementById("CPID").innerHTML="Champion - "+a)}
function UpdateData(){"1"==IPInfoObj.Internet_Service_Select?(document.getElementById("INMode").innerHTML="DHCP IP : ",document.getElementById("INIP").innerHTML="-.-.-.-"):IPInfoObj.Web_Page_Mode&&("1"==IPInfoObj.Web_Page_Mode?(document.getElementById("INMode").innerHTML="Client Mode IP : ",document.getElementById("INIP").innerHTML=IPInfoObj.IP_Address):(document.getElementById("INMode").innerHTML="AP Mode IP : ",document.getElementById("INIP").innerHTML="192.168.0.90"));BingSN();1==FristLoad?(new Promise(function(a,
c){IPInfoObj.length=0;GetIPData=new createAJAX;if(!GetIPData)return alert("Not Support XMLHttpRequest"),0;GetIPData.open("GET",Debug?"./IPinfo.html":"./get_ipinfo",!0);ShowGet&&console.log(new Date+" = > get_ip_info");GetIPData.onreadystatechange=function(){4==GetIPData.readyState&&(200==GetIPData.status?(IPInfoObj=eval("("+GetIPData.responseText+")"),ShowApiData&&(console.log(new Date+" = > get_ipinfo data-----------------------"),console.log(IPInfoObj)),a("OK")):c("NG"))};GetIPData.send("")})).then(function(a){GetDivStr();
GetDivStr1();DataCh=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];window.setTimeout("Ch_Reflash('Arr1', 'FL');",200);FristLoad=!1},function(a){}):(GetDivStr(),ParaHasCh||GetDivStr1(),window.setTimeout("Ch_Reflash('Arr1;', 'UD');",200))}
function GetDivStr(){Storage_Arr=[];Storage_Arr.length=0;Storage_C=11;SystemDate=GetDateDiff(DataInfoObj.ATS_System_Datetime,9);Storage_Arr[0]=GetDateDiff(DataInfoObj.ATS_System_Datetime,0);Storage_Arr[1]=TraWeek(1,DataInfoObj.ATS_System_Week);Storage_Arr[2]=GetDateDiff(DataInfoObj.ATS_System_Datetime,1);Storage_Arr[3]=5*DataInfoObj.Maintainess_Time_Setting+"H";Storage_Arr[4]=ReTurnStr(DataInfoObj.Day_Light_Saving_Setting);Storage_Arr[5]=ExMode[TranMode(0,parseInt(DataInfoObj.Exercise_Attempts_Setting,
10))];Storage_Arr[6]=TraWeek(1,DataInfoObj.Exercise_Week_Setting);Storage_Arr[7]=GetDateDiff(DataInfoObj.Exercise_Time_Setting,2);Storage_Arr[8]=IS_Arr[IPInfoObj.Internet_Service_Select];Storage_Arr[9]=WPM_Arr[IPInfoObj.Web_Page_Mode];Storage_Arr[10]=RemoveBlank(IPInfoObj.SSID)}
function GetDivStr1(){Storage_Arr1=[];Storage_Arr1.length=0;Storage_Arr1[0]=GetDateDiff(DataInfoObj.ATS_System_Datetime,0);Storage_Arr1[1]=TraWeek(1,DataInfoObj.ATS_System_Week);Storage_Arr1[2]=GetDateDiff(DataInfoObj.ATS_System_Datetime,1);Storage_Arr1[3]=5*DataInfoObj.Maintainess_Time_Setting+"H";Storage_Arr1[4]=ReTurnStr(DataInfoObj.Day_Light_Saving_Setting);Storage_Arr1[5]=ExMode[TranMode(0,parseInt(DataInfoObj.Exercise_Attempts_Setting,10))];Storage_Arr1[6]=TraWeek(1,DataInfoObj.Exercise_Week_Setting);
Storage_Arr1[7]=GetDateDiff(DataInfoObj.Exercise_Time_Setting,2);Storage_Arr1[8]=IS_Arr[IPInfoObj.Internet_Service_Select];Storage_Arr1[9]=WPM_Arr[IPInfoObj.Web_Page_Mode];Storage_Arr1[10]=RemoveBlank(IPInfoObj.SSID)}
function GetComStr(){var a;ComStr="";var c=GetDateDiff(Storage_Arr1[0]+" "+Storage_Arr1[2],3);var e=TraWeek(0,Storage_Arr1[1])+1;var f="On"==Storage_Arr1[4]?1:0;var g=TW(Storage_Arr1[3].replace("H","")/5);for(i=0;6>i;i++)Storage_Arr1[5]==ExMode[i]&&(a=TranMode(1,i));var h=TraWeek(0,Storage_Arr1[6])+1;var k=GetDateDiff(Storage_Arr1[0]+" "+Storage_Arr1[7],4);ComStr+="./SETTINGS?";ComStr=ComStr+"ATS_System_Date="+c.substr(0,10)+"&";ComStr=ComStr+"ATS_System_Time="+c.substr(11,8)+"&";ComStr=ComStr+"ATS_System_Week="+
e+"&";ComStr=ComStr+"Day_Light_Saving="+f+"&";ComStr=ComStr+"Maintainess_Time="+g+"&";ComStr=ComStr+"Exercise_Attempts="+a+"&";ComStr=ComStr+"Exercise_Week="+h+"&";return ComStr=ComStr+"Exercise_Time="+k+"&"}
function GetWifiComStr(a){ComStr="";var c=document.getElementById("S2_7").value;var e=GetIPValue("S2_4_");var f=GetIPValue("S2_5_");var g=GetIPValue("S2_6_");var h=AP_list[parseInt(document.getElementById("S2_2").value,10)];var k=h.search("=>");h.substr(0,k);k=document.getElementById("S2_3").value;var l=!1;1==document.getElementById("S2_0").value&&(l=!0);var m=!1;0==document.getElementById("S2_1").value&&(m=!0);ComStr+="./CONFIG?";ComStr=ComStr+"security="+c+"&";"1"==a&&(ComStr=ComStr+"ip_address="+
e+"&",ComStr=ComStr+"mask="+f+"&",ComStr=ComStr+"gateway="+g+"&",ComStr=ComStr+"ssid="+h+"&",ComStr=ComStr+"password="+k+"&");ComStr=ComStr+"cloud="+l+"&";return ComStr=ComStr+"ap="+m+"&"}
function TimeEdit(a){TimeIsCh=!0;Vis("TiSet");Hid("TiData");CleanDiv(0,5);dynamicRadioButton(0,"Div0_4",Storage_Arr1[4]);for(x=0;8>x;x++){var c=document.getElementById("S0_"+x);var e=[];switch(x){case 0:e=M_Arr;var f=12;break;case 1:for(z=0;31>z;z++)e[z]=TW(z+1);f=31;break;case 2:for(z=0;21>z;z++)e[z]=2019+z;f=20;break;case 3:e=D_Arr;f=7;break;case 4:for(z=0;12>z;z++)e[z]=0==z?TW(0):TW(z);f=12;break;case 5:for(z=0;60>z;z++)e[z]=TW(z);f=60;break;case 6:e=PAM_Arr;f=2;break;case 7:for(z=0;40>z;z++)e[z]=
5*(z+1)+"H";f=40}S0LF[x]=f;for(i=c.options.length=0;i<f;i++)c.options.add(new Option(e[i],i));switch(x){case 0:c.options.add(new Option("Choose Month...",f));break;case 1:c.options.add(new Option("Choose Day...",f));break;case 2:c.options.add(new Option("Choose Year...",f));break;case 4:c.options.add(new Option("Choose Hour...",f));break;case 5:c.options.add(new Option("Choose Minute...",f));break;case 6:c.options.add(new Option("Choose AM/PM...",f))}"GetTime"!=a&&3!=x&&(c.value=f);if("GetTime"==
a)switch(x){case 0:c.value=GetDateDiff(Storage_Arr1[0],12)-1;break;case 1:c.value=GetDateDiff(Storage_Arr1[0],13)-1;break;case 2:c.value=GetDateDiff(Storage_Arr1[0],11)-2019;break;case 3:c.value=TraWeek(0,Storage_Arr1[1]);break;case 4:c.value=parseInt(GetDateDiff(Storage_Arr1[2],15),10);break;case 5:59>parseInt(GetDateDiff(Storage_Arr1[2],16),10)?c.value=parseInt(GetDateDiff(Storage_Arr1[2],16),10)+1:c.value=parseInt(GetDateDiff(Storage_Arr1[2],16),10);break;case 6:c.value=parseInt(GetDateDiff(Storage_Arr1[2],
14),10);break;case 7:c.value=parseInt(Storage_Arr1[3].replace("H",""),10)/5-1}}ChangeSetCss(1,"TimeSet();")}
function TimeSet(a){var c=CheckDate();if("Cancel"==a||"NoSet"==c)Vis("TiData"),Hid("TiSet");else{if("Date"==c)return alert("Date Error !"),"";if("Time"==c)return alert("Time Error !"),"";for(z=0;5>z;z++){a="";switch(z){case 0:a+=M_Arr[parseInt(document.getElementById("S0_0").value,10)];a=a+"  "+TW(parseInt(document.getElementById("S0_1").value,10)+1);a=a+"  "+(parseInt(document.getElementById("S0_2").value,10)+2019).toString();break;case 1:a=D_Arr[parseInt(document.getElementById("S0_3").value,10)];
break;case 2:a+=TW(parseInt(document.getElementById("S0_4").value,10));a=a+":"+TW(parseInt(document.getElementById("S0_5").value,10));a=a+" "+PAM_Arr[parseInt(document.getElementById("S0_6").value,10)];break;case 3:a=5*(parseInt(document.getElementById("S0_7").value,10)+1)+"H";break;case 4:a=document.getElementById("Radio0_0").checked?"Off":"On"}dynamicSPAN("Div0_"+z,a,1);Storage_Arr1[z]=a;ParaHasCh=DataCh[z]=!0;ChButtonCss();Vis("TiData");Hid("TiSet")}Hid("HID0")}CancelSetCss(1,"TimeEdit('');")}
function ExerciseEdit(a){Vis("EFSet");Hid("EFData");CleanDiv(5,3);for(x=0;5>x;x++){var c=[];var e=document.getElementById("S1_"+x);e.id="S1_"+x;switch(x){case 0:c=ExMode;var f=5;break;case 1:c=D_Arr;f=7;break;case 2:for(z=0;12>z;z++)c[z]=0==z?TW(0):TW(z);f=12;break;case 3:for(z=0;60>z;z++)c[z]=TW(z);f=60;break;case 4:c=PAM_Arr,f=2}S1LF[x]=f;for(i=e.options.length=0;i<f;i++)e.options.add(new Option(c[i],i));switch(x){case 0:e.options.add(new Option("Choose Mode...",f));e.value=f;break;case 1:e.options.add(new Option("Choose Day...",
f));e.value=f;break;case 2:e.options.add(new Option("Choose Hour...",f));e.value=f;break;case 3:e.options.add(new Option("Choose Minute...",f));e.value=f;break;case 4:e.options.add(new Option("Choose AM/PM...",f)),e.value=f}if("NoSelect"==a)switch(x){case 0:for(i=0;i<f;i++)Storage_Arr1[5]==ExMode[i]&&(e.value=i);break;case 1:e.value=TraWeek(0,Storage_Arr1[6]);break;case 2:e.value=parseInt(GetDateDiff(Storage_Arr1[7],15),10);break;case 3:e.value=parseInt(GetDateDiff(Storage_Arr1[7],16),10);break;case 4:e.value=
parseInt(GetDateDiff(Storage_Arr1[7],14),10)}}CheckFeq();ChangeSetCss(2,"ExerciseSet();")}function CheckFeq(){var a=document.getElementById("S1_0").value,c=!1;if(0==a||5==a)c=!0;for(x=1;5>x;x++)Sel=document.getElementById("S1_"+x),Sel.disabled=c}
function ExerciseSet(){console.log();if(document.getElementById("S1_0").value==S1LF[0]){console.log();var a=!0;for(x=0;5>x;x++)document.getElementById("S1_"+x).value!=S1LF[x]&&(a=!1);a&&ExerciseEdit("NoSelect")}else if(0==document.getElementById("S1_0").value)for(x=0;5>x;x++)switch(Sel=document.getElementById("S1_"+x),x){case 1:Sel.value=TraWeek(0,Storage_Arr1[6]);break;case 2:Sel.value=parseInt(GetDateDiff(Storage_Arr1[7],15),10);break;case 3:Sel.value=parseInt(GetDateDiff(Storage_Arr1[7],16),10);
break;case 4:Sel.value=parseInt(GetDateDiff(Storage_Arr1[7],14),10)}else{a=!1;for(x=1;5>x;x++)document.getElementById("S1_"+x).value==S1LF[x]&&(a=!0);if(a)return alert("Please Select Item!!"),!1}Vis("EFData");Hid("EFSet");for(z=5;8>z;z++){a="";var c=0;switch(z){case 5:a=ExMode[parseInt(document.getElementById("S1_0").value,10)];break;case 6:a=D_Arr[parseInt(document.getElementById("S1_1").value,10)];break;case 7:a+=TW(parseInt(document.getElementById("S1_2").value,10)),a=a+":"+TW(parseInt(document.getElementById("S1_3").value,
10)),a=a+" "+PAM_Arr[parseInt(document.getElementById("S1_4").value,10)]}a!=Storage_Arr1[z]?(dynamicSPAN("Div0_"+z,a,1),Storage_Arr1[z]=a,ParaHasCh=!0,DataCh[z]=!0,ChButtonCss()):(DataCh[z]&&(ChButtonCss(),c=1),dynamicSPAN("Div0_"+z,Storage_Arr1[z],c))}CancelSetCss(2,"ExerciseEdit();")}
function NETEdit(){EditFlag[2]=!0;SleepTime("WIFI",SleepTimer,100);(new Promise(function(a,c){WifiInfoObj.length=0;GetWifiData=new createAJAX;if(!GetWifiData)return alert("Not Support XMLHttpRequest"),0;var e=Debug?"./aplist.html":"./get_aplist";GetWifiData.timeout="5000";GetWifiData.open("GET",e,!0);ShowGet&&console.log(new Date+" = > get_aplist");GetWifiData.onreadystatechange=function(){4==GetWifiData.readyState&&200==GetWifiData.status&&(WifiInfoObj=eval("("+GetWifiData.responseText+")"),WifiInfoObj=
SortCheckNull(WifiInfoObj,"rssi"),ShowApiData&&(console.log(new Date+" = > get_aplist data-----------------------"),console.log(WifiInfoObj)),a("OK"))};GetWifiData.send("")})).then(function(a){a=JsonSort(WifiInfoObj,"rssi");document.getElementById("Div0_8").innerHTML="";document.getElementById("Div0_9").innerHTML="";document.getElementById("Div0_10").innerHTML="";for(x=0;3>x;x++){var c=0==x?document.getElementById("Div0_8"):1==x?document.getElementById("Div0_9"):document.getElementById("Div0_10");
var e=[];var f=document.createElement("select");f.className="SelectCss";f.id="S2_"+x;switch(x){case 0:e=IS_Arr;var g=2;break;case 1:e=WPM_Arr;g=2;break;case 2:for(i=0;i<a.length;i++){var h=a[i].rssi;h=parseInt(h.replace("%",""),10);AP_WifiSS[i]=h;e[i]=a[i].ssid;AP_list[i]=a[i].ssid;g=a.length}}for(i=0;i<g;i++)f.options.add(new Option(e[i],i));c.appendChild(f);switch(x){case 0:for(i=0;i<g;i++)Storage_Arr1[8]==IS_Arr[i]&&(f.value=i);break;case 1:for(i=0;i<g;i++)Storage_Arr1[9]==WPM_Arr[i]&&(f.value=
i);break;case 2:for(h=RemoveBlank(IPInfoObj.SSID),i=0;i<a.length;i++)h==a[i].ssid&&(f.value=i)}}c.appendChild(document.createElement("br"));f=document.getElementById("S2_7");e=NetT_Arr;for(i=f.options.length=0;i<NetT_Arr.length;i++)f.options.add(new Option(e[i],i));f.value=IPInfoObj.Security;document.getElementById("S2_3").value="";IPEmpty("S2_4_");IPEmpty("S2_5_");IPEmpty("S2_6_");c=IPInfoObj.SSID;c=c.replace(" ","");c=c.replace(" ","");c=c.replace(" ","");c=c.replace(" ","");c=c.replace(" ","");
for(b=0;b<a.length;b++)a[b].ssid==c&&(document.getElementById("Div0_10").value=IPInfoObj.SSID);document.getElementById("S2_0").value=IPInfoObj.Internet_Service_Select;document.getElementById("S2_1").value=IPInfoObj.Web_Page_Mode;document.getElementById("S2_0").setAttribute("onchange","SelChangeMode()");document.getElementById("S2_1").setAttribute("onchange","SelChangeMode()");ChangeSetCss(3,"NETSet();");SelChangeMode();Vis("HID3")},function(a){})}
function GetAbsolutePos(a){for(var c={x:0,y:0};null!=a;)c.x+=a.offsetLeft,c.y+=a.offsetTop,a=a.offsetParent;return c}function IPEmpty(a){for(var c=0;4>c;c++)document.getElementById(a+c).value=""}function GetIPValue(a){for(var c="",e=0;4>e;e++)c=c+document.getElementById(a+e).value+".";return c=c.substr(0,c.length-1)}function IPCh(a){AutoChangeFocus(a)}function IPFOUT(a){clearTimeout(ACF_ti)}
var ACF_ti,StrLength=0,SeqArr="S2_4_0 S2_4_1 S2_4_2 S2_4_3 S2_5_0 S2_5_1 S2_5_2 S2_5_3 S2_6_0 S2_6_1 S2_6_2 S2_6_3".split(" "),SF=0;
function AutoChangeFocus(a){clearTimeout(ACF_ti);var c=document.getElementById(a).value;isNaN(c)?(alert("Value Error !"),document.getElementById(a).value="",document.getElementById(a).focus()):(0>parseInt(c)&&(alert("Value Error !"),document.getElementById(a).value=0,document.getElementById(a).focus()),255<parseInt(c)&&(alert("Value Error !"),document.getElementById(a).value=255,document.getElementById(a).focus()));document.getElementById(a).value=document.getElementById(a).value.replace(".","");
0<StrLength&&3!=StrLength&&3==document.getElementById(a).value.length&&NextFocus(a);StrLength=document.getElementById(a).value.length;ACF_ti=window.setTimeout("AutoChangeFocus('"+a+"')",100)}function NextFocus(a){document.getElementById(a).value=parseInt(document.getElementById(a).value);for(var c=0;12>c;c++)if(a==SeqArr[c]&&11!=c){c+=1;clearTimeout(ACF_ti);document.getElementById(SeqArr[c]).focus();break}}
function ShowWifiSS(){var a=document.getElementById("SWSSDiv");if("none"==a.style.display)for(a.style.display="block",document.getElementById("SWSS").innerHTML="Hidden Wifi Signal Strength",console.log(AP_list),console.log(AP_WifiSS),a.innerHTML="",x=0;x<AP_list.length;x++){var c=document.createElement("div");c.className="WifiSSdata";var e=document.createElement("img");e.className="WifiImg";e.src=75<=AP_WifiSS[x]?"images/Wifi1.png":50<AP_WifiSS[x]?"images/Wifi2.png":25<AP_WifiSS[x]?"images/Wifi3.png":
"images/Wifi4.png";c.appendChild(e);e=document.createElement("div");e.className="WifiSSLable";var f=document.createElement("span");f.className="ML5";f.innerText=AP_list[x];e.appendChild(f);c.appendChild(e);e=document.createElement("div");e.className="WifiSSLable1";f=document.createElement("span");f.className="ML5";f.innerText="rssi: "+AP_WifiSS[x];e.appendChild(f);c.appendChild(e);a.appendChild(c)}else a.style.display="none",document.getElementById("SWSS").innerHTML="Show Wifi Signal Strength"}
function NETSet(){var a=document.getElementById("S2_3").value,c=document.getElementById("S2_7").value,e=document.getElementById("S2_1").value,f=document.getElementById("S2_0").value;if(0==a.length&&"0"!=c&&"0"!=e)return alert("Password can't be empty !"),1;if("1"==f){if(!confirm("Cloud Service\n\nConfirm network setting modification?")){console.log("Cancel");return}}else{if("1"==e){a=["Web Address can't be empty !","Mask can't be empty !","GateWay can't be empty !"];for(c=4;7>c;c++)for(f=0;4>f;f++)if(""==
document.getElementById("S2_"+c+"_"+f).value)return alert(a[c-4]),1;a=GetIPValue("S2_4_");c=GetIPValue("S2_5_");f=GetIPValue("S2_6_");if(!f_check_IP(a))return alert("Web Address Error !"),1;if(!f_check_IP(c))return alert("Mask Address Error !"),1;if(!f_check_IP(f))return alert("GateWay Address Error !"),1;var g="Please Double Check Setting Value !\n\nSSID : "+AP_list[parseInt(document.getElementById("S2_2").value)]+"\n";g=g+"PassWord : "+document.getElementById("S2_3").value+"\n";g=g+"Web Address : "+
a+"\nMask : "+c+"\nGateWay : "+f+"\n";g=g+"Security : "+NetT_Arr[parseInt(document.getElementById("S2_7").value)]+"\n\n";g+="If Setting Error\uff0cPlease Reset Hardware !\n\n";g+="Confirm network setting modification?"}else g="AP Mode IP => 192.168.0.90 !\n\nConfirm network setting modification?";if(!confirm(g)){console.log("Cancel");return}}a=GetWifiComStr(e);1==Debug?(console.log(a),SleepTime("CUP",5,100),clearTimeout(GD_ti),FristLoad=!0,setTimeout("GetAPIData('"+DatastrUrl+"')",5E3)):(console.log(a),
SandCmd(a));"0"==e?SetNetMode="AP":"1"==e&&(SetNetMode="CL");setTimeout("SetNetMode = '-'",3E4);Ch_Reflash("Arr1","FL");Hid("HID2");Hid("HID3");Hid("IPDiv_1");Hid("IPDiv_2");Hid("IPDiv_3");CancelSetCss(3,"NETEdit();")}function f_check_IP(a){return/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(a)&&256>RegExp.$1&&256>RegExp.$2&&256>RegExp.$3&&256>RegExp.$4?!0:!1}
function SelChangeMode(){var a=document.getElementById("S2_0").value,c=document.getElementById("S2_1").value;if("1"==a)document.getElementById("IPFromTital").innerHTML="DHCP",Hid("HID1"),Vis("HID2"),Hid("IPDiv_1"),Hid("IPDiv_2"),Hid("IPDiv_3");else if(document.getElementById("IPFromTital").innerHTML="Client Mode",Vis("HID1"),"1"==c){Vis("HID2");try{var e=IPInfoObj.IP_Address.split("."),f=IPInfoObj.Mask.split("."),g=IPInfoObj.Gateway.split(".");for(a=0;4>a;a++)document.getElementById("S2_4_"+a).value=
e[a],document.getElementById("S2_5_"+a).value=f[a],document.getElementById("S2_6_"+a).value=g[a]}catch(h){}Vis("IPDiv_1");Vis("IPDiv_2");Vis("IPDiv_3")}else Hid("HID2"),Hid("IPDiv_1"),Hid("IPDiv_2"),Hid("IPDiv_3")}function Cancel_NetWork_Setting(){confirm("Do you want to cancel the modification?")&&(dynamicSPAN("Div0_8",Storage_Arr[8],0),dynamicSPAN("Div0_9",Storage_Arr[9],0),Hid("HID1"),Hid("HID2"),Hid("HID3"),CancelSetCss(3,"NETEdit();"))}
function ApplyChange(){console.log("ApplyChange");if(1==EditFlag[0]||1==EditFlag[1]){if(EditFlag[1])var a=" EXERCISE FREQUENCY";EditFlag[0]&&(a=" DATE & TIME");alert("Please Confirm "+a+" first!!")}else confirm("Do you want to apply the modification?")&&(a=GetComStr(),1==Debug?(console.log(a),SleepTime("CUP",5,100),clearTimeout(GD_ti),FristLoad=!0,setTimeout("GetAPIData('"+DatastrUrl+"')",5E3)):(console.log(a),SandCmd(a)),CancelSetCss(3,"NETEdit();"),ParaHasCh=TimeIsCh=!1)}
function CancalTimeSet(){confirm("Do you want to cancel the modification?")&&(GetTimeNow(),TimeSet("Cancel"),CancelSetCss(1,"TimeEdit('');"),FristLoad=!0,GetAPIData(DatastrUrl),ParaHasCh=TimeIsCh=!1)}function CancalExerSet(){confirm("Do you want to cancel the modification?")&&(ExerciseSet(),CancelSetCss(2,"ExerciseEdit();"),FristLoad=!0,GetAPIData(DatastrUrl))}
function Ch_Reflash(a,c){if("Arr"==a)for(i=0;i<Storage_C;i++)dynamicSPAN("Div0_"+i,Storage_Arr[i]);else for(i=0;i<Storage_C;i++){var e=0;1==DataCh[i]&&(ChButtonCss(),e=1);5>i?0==EditFlag[0]&&(0==DataCh[i]?2==i?dynamicSPAN("Div0_"+i,SystemDate,e):dynamicSPAN("Div0_"+i,Storage_Arr[i],e):dynamicSPAN("Div0_"+i,Storage_Arr1[i],e)):8>i?0==EditFlag[1]&&(0==DataCh[i]?dynamicSPAN("Div0_"+i,Storage_Arr[i],e):dynamicSPAN("Div0_"+i,Storage_Arr1[i],e)):0==EditFlag[2]&&dynamicSPAN("Div0_"+i,Storage_Arr1[i],e)}"FL"==
c&&(document.getElementById("SaveDiv").style.display="none");1==IPInfoObj.Internet_Service_Select&&1!=EditFlag[2]?Hid("HID1"):0==IPInfoObj.Internet_Service_Select&&1!=EditFlag[2]&&Vis("HID1")}
function GetDateDiff(a,c){if(2==c){var e=a.search(":");var f=11<parseInt(a.substr(0,e))?TW(parseInt(a.substr(0,e))-12)+":"+TW(parseInt(a.substr(e+1,a.length)),10)+" PM":TW(parseInt(a.substr(0,e)))+":"+TW(parseInt(a.substr(e+1,a.length)),10)+" AM"}else if(14==c||15==c||16==c)switch(c){case 14:f=0;"PM"==a.substr(6,2)&&(f=1);break;case 15:f=a.substr(0,2);break;case 16:f=a.substr(3,2)}else{var g=new Date(a.replace(/\-/g,"/"));e=g.getFullYear();var h=g.getMonth(),k=g.getDate();g.getDay();var l=g.getHours(),
m=g.getHours(),p="AM";11<l&&(l-=12,p="PM");var n=g.getMinutes(),q=g.getSeconds();g=g.getDay();switch(c){case 0:f=M_Arr[h]+"  "+TW(k)+"  "+e;break;case 1:f=TW(l)+":"+TW(n)+" "+p;break;case 3:f=e+"-"+TW(h+1)+"-"+TW(k)+" "+TW(m)+":"+TW(n);break;case 4:f=TW(m)+":"+TW(n);break;case 5:f=g-1;break;case 9:f=TW(l)+":"+TW(n)+":"+TW(q)+"  "+p;break;case 11:f=e;break;case 12:f=h+1;break;case 13:f=k}}return f}
function dynamicRadioButton(a,c,e){containerDiv=document.getElementById(c);c=document.createElement("input");c.className="radioStyle";c.setAttribute("type","radio");c.setAttribute("id","Radio"+a+"_1");c.setAttribute("name","Boolean"+a);c.style.cursor="pointer";var f=document.createElement("label");f.innerHTML="On";f.className="ML3";containerDiv.appendChild(c);containerDiv.appendChild(f);c=document.createElement("span");c.setAttribute("innerHTML","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp");containerDiv.appendChild(c);
c=document.createElement("input");c.className="radioStyle";c.setAttribute("type","radio");c.setAttribute("id","Radio"+a+"_0");c.setAttribute("name","Boolean"+a);c.style.marginLeft="20px";c.style.cursor="pointer";f=document.createElement("lable");var g=document.createTextNode("Off");f.appendChild(g);f.className="ML3";containerDiv.appendChild(c);containerDiv.appendChild(f);c=document.createElement("br");containerDiv.appendChild(c);0==e||"Off"==e?document.getElementById("Radio"+a+"_0").checked=!0:document.getElementById("Radio"+
a+"_1").checked=!0;return!1}function dynamicSPAN(a,c,e){"Div0_0"==a&&(c=c.substr(0,c.length-6)+","+c.substr(c.length-6,6));a=document.getElementById(a);a.innerHTML="";SP=document.createElement("div");SP.innerHTML=c;a.appendChild(SP);1==e&&(SP=document.createElement("div"),SP.className="UNspan",SP.innerHTML="  Unsaved Changes",a.appendChild(SP))}function TW(a){var c=a;10>a&&(c="0"+c);return c}function ReTurnStr(a){return"1"==a?"On":"Off"}function ReTurnInt(a){return"Off"==a?0:1}
function TraWeek(a,c){var e;if(0==a)for(var f=0;7>f;f++)D_Arr[f]==c&&(e=f);else e=D_Arr[parseInt(c,10)-1];return e}function CleanDiv(a,c){for(i=0;i<c;i++)document.getElementById("Div0_"+(a+i)).innerHTML=""}
function JsonSort(a,c){for(var e=[],f=0,g=1,h=a.length;g<h;g++){var k=a[g];val=parseInt(k[c].replace("%",""),10);for(i=g-1;0<=i&&parseInt(a[i][c].replace("%",""),10)<val;)a[i+1]=a[i],--i;a[i+1]=k}g=1;for(h=a.length;g<h;g++)""==a[g].ssid&&(e[f]=g,f++);for(x=f-1;0<=x;x--)a.splice(e[x],1);return a}
function ChButtonCss(){document.getElementById("SaveDiv").style.display="inline";document.getElementById("Button4").setAttribute("onclick","ApplyChange('Arr','FL');");document.getElementById("Button5").setAttribute("onclick","RevertChange();")}function Transformation(a,c,e){for(x=0;x<c;x++)if(a[x]==e)return x}function RemoveBlank(a){var c=0;for(x=15;0<=x;x--)if(" "!=a.substr(x,1)){c=x;break}return a.substr(0,c+1)}
function SleepTime(a,c,e){c*=1E3;"WIFI"==a?document.getElementById("SDTital").innerHTML="Search AP ...":"CUP"==a?document.getElementById("SDTital").innerHTML="Saving Configuration":"loading"==a&&(document.getElementById("SDTital").innerHTML="Updating ...");document.getElementById("SleepDiv1").style.visibility="visible";for(x=1;x<=e;x++){a=c/(e+1)*x;var f=parseInt(100/e*x,10)+"%";setTimeout("document.getElementById('SPBar').style.width = '"+200/e*x+"px'",a);setTimeout("document.getElementById('SPBarV').innerHTML = '"+
f+"'",a)}setTimeout("document.getElementById('SleepDiv1').style.visibility = 'hidden'",c)}function ChangeSetCss(a,c){document.getElementById("Label"+a).innerHTML=CHSC_Arr[a];document.getElementById("IMG"+a).src="images/PAN.png";var e=document.getElementById("Button"+a);e.className="ButtonD BR myMOUSE";e.setAttribute("onclick",c);EditFlag[a-1]=!0;1==a?ShowBlock("CancelB1"):2==a?ShowBlock("CancelB2"):3==a&&ShowBlock("CancelB3")}
function CancelSetCss(a,c){document.getElementById("Label"+a).innerHTML=CASC_Arr[a];document.getElementById("IMG"+a).src="images/PAN.png";var e=document.getElementById("Button"+a);e.className="ButtonD myMOUSE";e.setAttribute("onclick",c);EditFlag[a-1]=!1;1==a?Hidden("CancelB1"):2==a?Hidden("CancelB2"):3==a&&Hidden("CancelB3")}function Hidden(a){document.getElementById(a)&&(document.getElementById(a).style.display="none")}
function ShowBlock(a){document.getElementById(a)&&(document.getElementById(a).style.display="block")}function ShowInBlock(a){document.getElementById(a)&&(document.getElementById(a).style.display="inline block")}function Hid(a){document.getElementById(a).style="visibility:hidden;position: absolute;top:0; left: 20px;"}function Vis(a){document.getElementById(a).style="visibility:visible;position: relative;"}function TranMode(a,c){return c}function ShowDetail(){Vis("HID1");Vis("HID2")}
function GetTime(a,c){var e=new Date(a),f=e.getFullYear(),g=9>e.getMonth()?"0"+(e.getMonth()+1):e.getMonth()+1,h=10>e.getDate()?"0"+e.getDate():e.getDate(),k=10>e.getHours()?"0"+e.getHours():e.getHours(),l=10>e.getMinutes()?"0"+e.getMinutes():e.getMinutes();e=10>e.getSeconds()?"0"+e.getSeconds():e.getSeconds();switch(c){case 0:var m=f+"-"+g+"-"+h+" "+k+":"+l+":"+e}return m}
function ShowGenData(){d=DataInfoObj;BingSN();var a=[GetTime(new Date,0),d.ATS_System_Datetime,d.ATS_System_Status,d.ATS_Event,d.ATS_Util_ACV_RN+" V",d.ATS_Util_AC_Freq+" Hz",d.ATS_GEN_ACV_UN+" V",d.ATS_GEN_AC_Freq+" Hz",d.ATS_Load_ACV_L12+" V",d.ATS_Load_L1N_KW+" KW",d.ATS_Load_L1N_KVA+" KVA",d.ATS_Load_ACA_L1+" A",d.ATS_Util_ACV_SN+" V",d.ATS_Util_ACV_RS+" V",d.ATS_GEN_ACV_VN+" V",d.ATS_GEN_ACV_UV+" V",d.ATS_Load_L2N_KW+" KW",d.ATS_Load_Total_KW+" KW",d.ATS_Load_L2N_KVA+" KVA",d.ATS_Load_Total_KVA+
" KVA",d.ATS_Load_ACA_L2+" A"];for(x=0;x<a.length;x++){var c=10>x?"0"+x:x;document.getElementById("D1_"+c).innerHTML=a[x]}Binglight("ATSLIT",d.ATS_LIT_A,d.ATS_LIT_B);Binglight("Relay",d.ATS_Relay);Binglight("ControlTime",d.ATS_Control_TIMER);Binglight("AGPS",d.ATS_Gen_Power_Status);Binglight("AUPS",d.ATS_Util_Power_Status);BindSwitch12("SP0_",d.ATS_DIP_B_Status,1,8);BindSwitch12("SP0_",d.ATS_DIP_C_Status,9,4);BindSwitch10("SP1_",d.Gen_DIP_Switch_A,1,8);BindSwitch10("SP1_",d.Gen_DIP_Switch_B,9,2);
Bindknob("KA",d.ATS_DIP_A_Status,8);a=Cale("/",Math.floor(Cale("/",parseInt(d.Gen_RunHr_Minute,10),6)),10);a=Cale("+",parseInt(d.Gen_RunHr_Hour,10),a)+" Hr";c=Cale("/",Math.floor(Cale("/",parseInt(d.Gen_Maintain_Minute,10),6)),10);c=Cale("+",parseInt(d.Gen_Maintain_Hour,10),c)+" Hr";a=[d.Gen_System_Datetime,d.Gen_ACV_L12+" V",d.Gen_Freq+" Hz",d.Gen_Battery_Volt+" V",d.Gen_Crank_Total_Attempts,a,c,d.Gen_Err_Flag,d.Gen_Tracking_Record];for(x=0;x<a.length;x++)c=10>x?"0"+x:x,document.getElementById("D2_"+
c).innerHTML=a[x];Binglight("GASL",d.Gen_A_Set_Lit);Binglight("GBSL",d.Gen_B_Set_Lit);Binglight("GDI",d.Gen_Digital_Input);Binglight("GRO",d.Gen_Relay_Output);a=[d.Load_Shed_Relay0_Demand+" kW",d.Load_Shed_Relay1_Demand+" kW",d.Load_Shed_Relay2_Demand+" kW",d.Load_Shed_Relay3_Demand+" kW",d.Load_AC1_Demand+" kW",d.Load_AC2_Demand+" kW"];for(x=0;x<a.length;x++)c=10>x?"0"+x:x,document.getElementById("D3_"+c).innerHTML=a[x]}
function Binglight(a,c,e){var f=c+",",g=e+",";for(x=0;16>x;x++){var h=f.search(",");c=f.substr(0,h);"ATSLIT"==a?(e=g.substr(0,h),document.getElementById(a+x)&&(document.getElementById(a+x).src="images/gray.png","1"==c&&(document.getElementById(a+x).src="images/red.png"),"1"==e&&(document.getElementById(a+x).src="images/Green.png")),g=g.substr(h+1,g.length-2)):document.getElementById(a+x)&&("0"==c?document.getElementById(a+x).src="images/gray.png":"1"==c&&(document.getElementById(a+x).src="images/red.png"));
f=f.substr(h+1,f.length-2)}}function GreatData(a,c,e){var f=document.getElementById(a);f.innerHTML="";for(x=0;x<c.length;x++){var g=document.createElement("div");g.className=e;"ATSLIT"!=a||4!=x&&8!=x&&10!=x||(g.style.marginTop="10px");var h=document.createElement("img");h.className="BI1";h.src="images/gray.png";h.id=a+x;g.appendChild(h);h=document.createElement("span");h.className="GDTital_1 ML5";h.innerText=c[x];g.appendChild(h);f.appendChild(g)}}
function GreatSwitch16(a,c){var e=document.getElementById(a);e.innerHTML="";for(x=0;16>x;x++){var f=document.createElement("div");f.className="SWD";var g=document.createElement("div");g.className="SwithS1";var h=10>x+1?"0"+(x+1):x+1;g.innerHTML=h;f.appendChild(g);g=document.createElement("div");g.className="SwithBG1";f.appendChild(g);g=document.createElement("div");g.className="SwithC2";g.id=c+h;f.appendChild(g);e.appendChild(f)}}
function GreatSwitch12(a,c){var e=document.getElementById(a);e.innerHTML="";for(x=12;0<x;x--){var f=document.createElement("div");f.className="SWD";document.createElement("div");var g=document.createElement("div");g.className="SwithS1";12==x&&(g.innerHTML="on",g.style.fontSize="16px");f.appendChild(g);g=document.createElement("div");g.className="SwithBG1";f.appendChild(g);g=document.createElement("div");g.className="SwithC2";g.id=c+x;f.appendChild(g);g=document.createElement("div");g.className="SwithS1";
g.innerHTML=13-x;f.appendChild(g);e.appendChild(f)}}
function GreatSwitch10(a,c){var e=document.getElementById(a);e.innerHTML="";for(x=10;0<x;x--){var f=document.createElement("div");f.className="SWD";document.createElement("div");var g=document.createElement("div");g.className="SwithS1";10==x&&(g.innerHTML="on",g.style.fontSize="16px");f.appendChild(g);g=document.createElement("div");g.className="SwithBG1";f.appendChild(g);g=document.createElement("div");g.className="SwithC2";g.id=c+x;f.appendChild(g);g=document.createElement("div");g.className="SwithS1";
g.innerHTML=11-x;f.appendChild(g);e.appendChild(f)}}function BindSwLable(a,c){var e=document.getElementById(a);e.innerHTML="";for(x=0;x<c.length;x++){var f=document.createElement("div");f.className="Gendata";var g=document.createElement("span");g.className="GDTital_2";g.innerText="Switch "+(x+1)+" : ";f.appendChild(g);g=document.createElement("span");g.className="ML5";g.innerText=c[x];f.appendChild(g);e.appendChild(f)}}
function BindGenSwLable(a,c,e){a=document.getElementById(a);a.innerHTML="";for(x=0;x<c.length;x++){var f=document.createElement("div");f.className="Gendata";var g=document.createElement("div");g.className="GenTital_1";g.innerHTML=c[x];f.appendChild(g);g=document.createElement("div");g.className="GenTital_2";g.innerHTML=e[x];f.appendChild(g);a.appendChild(f)}}
function BindSwitch12(a,c,e,f){c+=",";for(var g,h=0;h<f;h++){g=c.search(",");var k=c.substr(0,g),l=e+h;document.getElementById(a+l)&&(document.getElementById(a+l).className="0"==k?"SwithC2":"SwithC1");c=c.substr(g+1,c.length-2)}}function BindSwitch10(a,c,e,f){c+=",";for(var g,h=0;h<f;h++){g=c.search(",");var k=c.substr(0,g),l=11-(e+h);document.getElementById(a+l)&&(document.getElementById(a+l).className="0"==k?"SwithC2":"SwithC1");c=c.substr(g+1,c.length-2)}}
function Bindknob(a,c,e){for(var f=1,g=c+",",h,k=c=0;k<e;k++){h=g.search(",");var l=g.substr(0,h);c+=parseInt(l)*f;f*=2;g=g.substr(h+1,g.length)}e=c.toString(16);document.getElementById("knobL").innerHTML=e+" kW";15<c?(f=e.substr(0,1),SetCss(a+1,"Knob_arrow A"+f),e=e.substr(1,e.length)):SetCss(a+1,"Knob_arrow A0");e=e.substr(0,1);SetCss(a+2,"Knob_arrow A"+e)}function SetCss(a,c){document.getElementById(a).className=c}
function ShowNote(a){var c=a.replace("B","Lable");a=a.replace("B","BL");c=document.getElementById(c);"none"==c.style.display?(c.style.display="block",document.getElementById(a).innerHTML="Hidden Switch Note"):(c.style.display="none",document.getElementById(a).innerHTML="Show Switch Note")}
function ButtonClick(a){document.getElementById("Page1").style.display="none";document.getElementById("Page2").style.display="none";document.getElementById("Page3").style.display="none";document.getElementById("PB_00").className="PageButtonI myMOUSE";document.getElementById("PB_01").className="PageButtonI myMOUSE";document.getElementById("PB_02").className="PageButtonI myMOUSE";switch(a){case "PB_00":document.getElementById("Page1").style.display="block";CiStr="P1Ci_";P1CiCount=9;break;case "PB_01":document.getElementById("Page2").style.display=
"block";CiStr="P2Ci_";P1CiCount=5;break;case "PB_02":document.getElementById("Page3").style.display="block",CiStr="P3Ci_",P1CiCount=1}document.getElementById(a).className="PageButtonI PBonI myMOUSE"}
function GoGo(a){var c=window.pageYOffset;switch(a){case "Gotop":var e=0;break;case "Top":e=0;for(x=P1CiCount-1;0<=x;x--)if(document.getElementById(CiStr+x)&&(a=document.getElementById(CiStr+x).offsetTop+0,a<c)){e=a;break}break;case "Down":for(x=0;x<P1CiCount;x++)if(document.getElementById(CiStr+x)&&(a=document.getElementById(CiStr+x).offsetTop+0,a>c)){e=a;break}}window.scroll(0,e)}function SortCheckNull(a,c){sor=function(e,f){return e[c]<f[c]?1:-1};a.sort(sor);return a}
function SNPage(){document.location.href="help.html"}function ShowMsg(a){document.getElementById("ShowMsg")&&(document.getElementById("MsgV").innerHTML=a,document.getElementById("ShowMsg").style.display="inline-block",window.setTimeout("document.getElementById('ShowMsg').style.display = 'none';",5E3))}
function Cale(a,c,e){switch(a){case "/":var f=a=0;try{a=c.toString().split(".")[1].length}catch(k){}try{f=e.toString().split(".")[1].length}catch(k){}var g=Number(c.toString().replace(".",""));var h=Number(e.toString().replace(".",""));return g/h*Math.pow(10,f-a);case "*":a=0;c=c.toString();e=e.toString();try{a=c.split(".")[1].length}catch(k){}try{a+=e.split(".")[1].length}catch(k){}return Number(c.replace(".",""))*Number(e.replace(".",""))/Math.pow(10,a);case "+":try{g=c.toString().split(".")[1].length}catch(k){g=
0}try{h=e.toString().split(".")[1].length}catch(k){h=0}a=Math.pow(10,Math.max(g,h));return(c*a+e*a)/a;case "-":try{g=c.toString().split(".")[1].length}catch(k){g=0}try{h=e.toString().split(".")[1].length}catch(k){h=0}a=Math.pow(10,Math.max(g,h));return((c*a-e*a)/a).toFixed(g>=h?g:h)}}
function WriteDefine(a){if("Time"==a)document.getElementById("S0_0")&&(document.getElementById("S0_0").value=GetDateDiff(Storage_Arr1[0],12)-1),document.getElementById("S0_1")&&(document.getElementById("S0_1").value=GetDateDiff(Storage_Arr1[0],13)-1),document.getElementById("S0_2")&&(document.getElementById("S0_2").value=GetDateDiff(Storage_Arr1[0],11)-2019),console.log("WriteDefine"),console.log(Storage_Arr1[1]),console.log(TraWeek(0,Storage_Arr1[1])),document.getElementById("S0_3")&&(document.getElementById("S0_3").value=
TraWeek(0,Storage_Arr1[1])),document.getElementById("S0_4")&&(document.getElementById("S0_4").value=parseInt(GetDateDiff(Storage_Arr1[2],15),10)),document.getElementById("S0_5")&&(59>parseInt(GetDateDiff(Storage_Arr1[2],16),10)?document.getElementById("S0_5").value=parseInt(GetDateDiff(Storage_Arr1[2],16),10)+1:document.getElementById("S0_5").value=parseInt(GetDateDiff(Storage_Arr1[2],16),10)),document.getElementById("S0_6")&&(document.getElementById("S0_6").value=parseInt(GetDateDiff(Storage_Arr1[2],
14),10)),document.getElementById("S0_7")&&(document.getElementById("S0_7").value=parseInt(Storage_Arr1[3].replace("H",""),10)/5-1);else if("Exer"==a){if(document.getElementById("S1_0")){for(i=0;4>i;i++)Storage_Arr1[5]==ExMode[i]&&(document.getElementById("S1_0").value=i);CheckFeq()}document.getElementById("S1_1")&&(document.getElementById("S1_1").value=TraWeek(0,Storage_Arr1[6]));document.getElementById("S1_2")&&(document.getElementById("S1_2").value=parseInt(GetDateDiff(Storage_Arr1[7],15),10));
document.getElementById("S1_3")&&(document.getElementById("S1_3").value=parseInt(GetDateDiff(Storage_Arr1[7],16),10));document.getElementById("S1_4")&&(document.getElementById("S1_4").value=parseInt(GetDateDiff(Storage_Arr1[7],14),10))}}function setCookie(a,c){var e=new Date;e.setTime(e.getTime()+2592E6);document.cookie=a+"="+escape(c)+";expires="+e.toGMTString()}function getCookie(a){a=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null}
function listCookies(){for(var a=document.cookie.split(";"),c="",e=1;e<=a.length;e++)c+=e+" "+a[e-1]+"\n";return c}function clearAllCookie(){for(var a=document.cookie.split(";"),c=1;c<=a.length;c++){var e=a[c-1].replace(" ","");e=e.substr(0,e.search("="));delCookie(e)}}function delCookie(a){var c=new Date;c.setTime(c.getTime()-1);var e=getCookie(a);null!=e&&(document.cookie=a+"="+e+";expires="+c.toGMTString())}
function GetDataInfo(){var a=new Date,c=a.getFullYear(),e=9>a.getMonth()?"0"+(a.getMonth()+1):a.getMonth()+1,f=10>a.getDate()?"0"+a.getDate():a.getDate(),g=10>a.getHours()?"0"+a.getHours():a.getHours(),h=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes();a=10>a.getSeconds()?"0"+a.getSeconds():a.getSeconds();return{controller_ID:"000000008642",Gen_ACV_L12:"0",Gen_Freq:"0",Gen_Battery_Volt:"25.6",Gen_RunHr_Minute:"47",Gen_RunHr_Hour:"1542",ATS_GCU_WIFI_Software_Reversion:" <1.0>  <1.0>  <1.0>",Gen_Crank_Total_Attempts:"609",
Gen_A_Set_Lit:"0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_B_Set_Lit:"1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_Maintain_Minute:"59",Gen_Maintain_Hour:"98",Gen_Relay_Output:"0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0",Gen_Digital_Input:"0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_DIP_Switch_A:"0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_DIP_Switch_B:"1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_System_Status:"0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Gen_Err_Flag:"GENSET_STOP",Gen_Tracking_Record:"WAITE CRANK STATE",ATS_Control_TIMER:"1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",
ATS_Util_ACV_RN:"0",ATS_Util_ACV_SN:"215",ATS_Util_ACV_RS:"214",ATS_Util_AC_Freq:"0",ATS_GEN_ACV_UN:"68",ATS_GEN_ACV_VN:"68",ATS_GEN_ACV_UV:"215",ATS_GEN_AC_Freq:"61.0",ATS_Load_ACV_L12:"0",ATS_Load_ACA_L1:"0.0",ATS_Load_ACA_L2:"0.0",ATS_Load_L1N_KW:"0.0",ATS_Load_L2N_KW:"0.0",ATS_Load_Total_KW:"0.0",ATS_Load_L1N_KVA:"0.0",ATS_Load_L2N_KVA:"0.0",ATS_Load_Total_KVA:"0.0",ATS_System_Status:"   ",ATS_LIT_A:"0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0",ATS_LIT_B:"0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0",ATS_DIP_A_Status:"0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0",
ATS_DIP_B_Status:"0,1,1,1,0,1,0,1,0,0,0,0,0,0,0,0",ATS_DIP_C_Status:"1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0",ATS_Util_Power_Status:"1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0",ATS_Relay:"0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0",ATS_System_Datetime:c+"-"+e+"-"+f+" "+g+":"+h+":"+a,ATS_System_Week:"1",ATS_Load_Shed_Relay:"0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0",ATS_Event:"ATS STATUS GENSET ABNORMAL",ATS_Gen_Power_Status:"0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0",Load_Shed_Relay0_Demand:"0.0",Load_Shed_Relay1_Demand:"0.0",Load_Shed_Relay2_Demand:"1.2",
Load_Shed_Relay3_Demand:"2.6",Load_AC2_Demand:"0.0",Load_AC1_Demand:"0.0",PID:"00010001000000008642",Day_Light_Saving_Setting:"1",Maintainess_Time_Setting:"100",Exercise_Attempts_Setting:"3",Exercise_Week_Setting:"3",Exercise_Time_Setting:"12:12",Gen_Execute_Cloud_Command:"0"}};